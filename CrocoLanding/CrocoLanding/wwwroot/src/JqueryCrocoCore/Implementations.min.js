var AjaxLoader=function(){function n(){}return n.prototype.InitAjaxLoads=function(){for(var t=document.getElementsByClassName("ajax-load-html"),n=0;n<t.length;n++)this.LoadInnerHtmlToElement(t[n],null)},n.prototype.LoadInnerHtmlToElement=function(n,t){var r=$(n).data("ajax-link"),i=$(n).data("ajax-method"),f=$(n).data("request-data"),u=$(n).data("on-finish-script");i==null&&(i="GET");$.ajax({type:i,url:r,cache:!1,data:f,success:function(i){$(n).html(i);$(n).removeClass("ajax-load-html");u&&eval(u);t&&t()},error:function(n){alert("There is an execption while executing request "+r);console.log(n)}})},n}(),Logger_Resx=function(){function n(){this.LoggingAttempFailed="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения";this.ErrorOnApiRequest="Ошибка запроса к апи";this.ActionLogged="Action logged";this.ExceptionLogged="Исключение залоггировано";this.ErrorOccuredOnLoggingException="Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения"}return n}(),Logger=function(){function n(){}return n.prototype.LogException=function(t,i,r){var u={ExceptionDate:(new Date).toISOString(),Description:i,Message:t,Uri:r!==null?r:location.href};CrocoAppCore.Application.Requester.Post("/Api/Log/Exception",u,function(t){return console.log(n.Resources.ExceptionLogged,t)},function(){return alert(n.Resources.ErrorOccuredOnLoggingException)})},n.prototype.LogAction=function(t,i,r,u){var f={LogDate:(new Date).toISOString(),EventId:r,ParametersJson:u,Uri:window.location.href,Description:i,Message:t};CrocoAppCore.Application.Requester.Post("/Api/Log/Action",f,function(t){return console.log(n.Resources.ActionLogged,t)},function(){return alert(n.Resources.LoggingAttempFailed)})},n.Resources=new Logger_Resx,n}(),ModalWorker=function(){function n(){}return n.prototype.ShowModal=function(t){(t===""||t==null||t==undefined)&&(t=n.LoadingModal);$("#"+t).modal("show")},n.prototype.ShowLoadingModal=function(){this.ShowModal(n.LoadingModal)},n.prototype.HideModals=function(){$(".modal").modal("hide");$(".modal-backdrop.fade").remove();$(".modal").on("shown.bs.modal",function(){})},n.prototype.HideModal=function(n){$("#"+n).modal("hide")},n.LoadingModal="loadingModal",n}(),MyCrocoJsApplication=function(){function n(){this.CookieWorker=new CookieWorker;this.FormDataUtils=new FormDataUtils;this.FormDataHelper=new FormDataHelper;this.Logger=new Logger;this.Requester=new Requester;this.ModalWorker=new ModalWorker}return n}(),Requester_Resx=function(){function n(){this.YouPassedAnEmtpyArrayOfObjects="Вы подали пустой объект в запрос";this.ErrorOccuredWeKnowAboutIt="Произошла ошибка! Мы уже знаем о ней, и скоро с ней разберемся!";this.FilesNotSelected="Файлы не выбраны"}return n}(),Requester=function(){function n(){}return n.prototype.DeleteCompletedRequest=function(t){n.GoingRequests=n.GoingRequests.filter(function(n){return n!==t})},n.prototype.PostWithAnimation=function(n,t,i,r){this.SendAjaxPostInner(n,t,i,r,!0)},n.prototype.UploadFilesToServer=function(t,i,r,u){var o=this,e=$("#"+t).prop("files"),s=new FormData,f;if(e.length===0){CrocoAppCore.ToastrWorker.ShowError(n.Resources.FilesNotSelected);u&&u();return}for(f=0;f<e.length;f++)s.append("Files",e[f]);$.ajax({url:i,type:"POST",data:s,async:!0,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(n){o.DeleteCompletedRequest(i);r&&r(n)}.bind(this),error:function(t,r,f){CrocoAppCore.Application.Logger.LogException(r.toString(),"ErrorOnApiRequest",i);o.DeleteCompletedRequest(i);CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt);u&&u(t,r,f)}.bind(this)})},n.OnSuccessAnimationHandler=function(n){CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.HandleBaseApiResponse(n)},n.OnErrorAnimationHandler=function(){CrocoAppCore.Application.ModalWorker.HideModals();CrocoAppCore.ToastrWorker.ShowError(n.Resources.ErrorOccuredWeKnowAboutIt)},n.prototype.Get=function(n,t,i,r){var u=this,f={type:"GET",data:t,url:n,async:!0,cache:!1,success:function(t){u.DeleteCompletedRequest(n);i&&i(t)}.bind(this),error:function(t,i,f){CrocoAppCore.Application.Logger.LogException(i.toString(),"Error on Api Request",n);u.DeleteCompletedRequest(n);r&&r(t,i,f)}.bind(this)};$.ajax(f)},n.prototype.SendAjaxPostInner=function(t,i,r,u,f){var o=this,e,s;if(i==null){alert(n.Resources.YouPassedAnEmtpyArrayOfObjects);return}e={};e.type="POST";e.data=i;e.url=t;e.async=!0;e.cache=!1;e.success=function(i){o.DeleteCompletedRequest(t);f&&n.OnSuccessAnimationHandler(i);r&&r(i)}.bind(this);e.error=function(i,r,e){CrocoAppCore.Application.Logger.LogException(r.toString(),"Error on Api Request",t);o.DeleteCompletedRequest(t);f&&n.OnErrorAnimationHandler();u&&u(i,r,e)}.bind(this);s=i.constructor===Array;s&&(e.contentType="application/json; charset=utf-8",e.dataType="json",e.data=JSON.stringify(i));n.GoingRequests.push(t);$.ajax(e)},n.prototype.Post=function(n,t,i,r){this.SendAjaxPostInner(n,t,i,r,!1)},n.Resources=new Requester_Resx,n.GoingRequests=[],n}(),ToastrWorker=function(){function n(){}return n.prototype.ShowError=function(n){var t={IsSucceeded:!1,Message:n};this.HandleBaseApiResponse(t)},n.prototype.ShowSuccess=function(n){var t={IsSucceeded:!0,Message:n};this.HandleBaseApiResponse(t)},n.prototype.HandleBaseApiResponse=function(n){if(n.IsSucceeded===undefined||n.Message===undefined){alert("Произошла ошибка. Объект не является типом BaseApiResponse");return}toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};n.IsSucceeded?toastr.success(n.Message):toastr.error(n.Message)},n}();